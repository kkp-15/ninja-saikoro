<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>サイコロの術 🎲</title>
<meta name="description" content="サイコロの数を選んでワンタップで振る、シンプルなダイスロール。大きい目で見やすいUI。" />

<style>
  :root{
    --bg:#f7f7fb; --fg:#111827; --muted:#6b7280; --accent:#111827;
    --die:#ffffff; --border:#e5e7eb; --radius:18px;
    --pip:28%;
    --gap:12px;
    --die-min:110px;
  }
  @media (prefers-color-scheme: dark){
    :root{ --bg:#0b0d12; --fg:#e5e7eb; --muted:#9aa2b2; --accent:#e5e7eb;
           --die:#15192d; --border:#2a2f45; }
  }
  *{box-sizing:border-box}
  body{
    margin:0; font-family: system-ui,-apple-system,"Segoe UI",Roboto,"Hiragino Kaku Gothic ProN",sans-serif;
    background:var(--bg); color:var(--fg); padding:16px; line-height:1.4;
  }
  h1{margin:0 0 8px; font-size: clamp(18px,4.5dvw,28px); font-weight:800;}
  .sub{color:var(--muted); margin-bottom:14px; font-size:.95rem}

  /* コントロール */
  .chips{display:flex; flex-wrap:wrap; gap:8px; margin-bottom:12px}
  .chip{
    border:1px solid var(--border); border-radius:999px; padding:10px 14px;
    background:transparent; color:var(--fg); font-weight:700; cursor:pointer;
  }
  .chip.active{ background: var(--fg); color: var(--bg); border-color: var(--fg); }
  .primary{
    width:100%; border:none; border-radius:14px; padding:16px 18px; font-weight:800;
    font-size: clamp(16px,3.8dvw,20px); color: var(--bg); background: var(--accent);
    cursor:pointer;
  }

  /* ダイス */
  .dice-area{
    margin-top:14px;
    display:grid; grid-template-columns: repeat(auto-fit, minmax(var(--die-min), 1fr));
    gap: var(--gap);
  }
  .dice-area.one{ --die-min: min(72dvw, 260px); --pip:34%; --gap:16px;}
  .dice-area.few{ --die-min: 140px; --pip:30%; --gap:14px;}
  .dice-area.many{ --die-min: 110px; --pip:26%; --gap:12px;}

  .die{
    aspect-ratio:1/1; border-radius: var(--radius); background: var(--die); border:1px solid var(--border);
    display:grid; place-items:center; position:relative;
  }
  .face{
    position:absolute; inset:8%; border-radius:14px;
    display:grid; grid-template-columns: repeat(3,1fr); grid-template-rows: repeat(3,1fr);
    place-items:center; gap:4%;
  }
  .pip{
    width: var(--pip); aspect-ratio:1/1; border-radius:50%; background:#111827;
    box-shadow: inset 0 -1px 1px rgba(255,255,255,.35);
  }
  @media (prefers-color-scheme: dark){
    .pip{ background:#ffffff; box-shadow:none; }
  }

  /* 結果 */
  .result{ margin-top:12px; font-weight:800; font-size: clamp(16px,3.5dvw,22px)}
  .hint{ color:var(--muted); font-size:.92rem; margin-top:6px}

  /* フッター（最小構成） */
  #footer{ margin-top:22px; color:var(--muted); font-size:.9rem; text-align:center}
  #footer a{ color:inherit; text-decoration:underline}
</style>
</head>
<body>
  <h1>サイコロの術 🎲</h1>
  <div class="sub">個数を選んで振るだけ。シンプル＆見やすい。</div>

  <div class="chips" id="chips">
    <button class="chip" data-n="1">1個</button>
    <button class="chip active" data-n="2">2個</button>
    <button class="chip" data-n="3">3個</button>
    <button class="chip" data-n="4">4個</button>
    <button class="chip" data-n="5">5個</button>
    <button class="chip" data-n="6">6個</button>
  </div>

  <button id="rollBtn" class="primary">振る！</button>

  <div id="diceArea" class="dice-area"></div>
  <div id="sum" class="result" style="display:none"></div>
  <div id="detail" class="hint" style="display:none"></div>

  <div id="footer">
    X <a href="https://x.com/kkp_webninja" target="_blank">@kkp_webninja</a> ・
    🏯 <a href="https://kkpwebninja.com" target="_blank">本丸</a>
  </div>

<script>
const $ = s => document.querySelector(s);
const $$ = s => [...document.querySelectorAll(s)];
const chips = $('#chips');
const diceArea = $('#diceArea');
const rollBtn = $('#rollBtn');
const sumEl = $('#sum');
const detailEl = $('#detail');

let diceCount = 2;

/* 3x3ピップ配置 */
function pipLayout(n){
  const one =   [0,0,0, 0,1,0, 0,0,0];
  const two =   [1,0,0, 0,0,0, 0,0,1];
  const three = [1,0,0, 0,1,0, 0,0,1];
  const four =  [1,0,1, 0,0,0, 1,0,1];
  const five =  [1,0,1, 0,1,0, 1,0,1];
  const six =   [1,0,1, 1,0,1, 1,0,1];
  return [one,two,three,four,five,six][n-1];
}
function createDie(face=1){
  const d = document.createElement('div');
  d.className = 'die';
  const f = document.createElement('div'); f.className = 'face';
  const layout = pipLayout(face);
  for(let i=0;i<9;i++){
    if(layout[i]){ const p=document.createElement('div'); p.className='pip'; f.appendChild(p); }
    else{ f.appendChild(document.createElement('div')); }
  }
  d.appendChild(f);
  return d;
}

/* レイアウトクラスを個数で切替 */
function applyGridClass(n){
  diceArea.classList.remove('one','few','many');
  if(n===1) diceArea.classList.add('one');
  else if(n<=3) diceArea.classList.add('few');
  else diceArea.classList.add('many');
}

/* ロール */
function roll(){
  applyGridClass(diceCount);
  diceArea.innerHTML = '';
  const faces = [];
  let sum = 0;
  for(let i=0;i<diceCount;i++){
    const r = Math.floor(Math.random()*6)+1;
    faces.push(r); sum += r;
    diceArea.appendChild(createDie(r));
  }
  sumEl.textContent = `合計 ${sum}`;
  detailEl.textContent = `内訳: ${faces.join(' / ')}`;
  sumEl.style.display = 'block';
  detailEl.style.display = 'block';
}

/* イベント */
chips.addEventListener('click', e=>{
  const b = e.target.closest('.chip'); if(!b) return;
  $$('.chip').forEach(c=>c.classList.remove('active'));
  b.classList.add('active');
  diceCount = parseInt(b.dataset.n,10);
  applyGridClass(diceCount);
});
rollBtn.addEventListener('click', roll);

/* 初期状態 */
applyGridClass(diceCount);
</script>
</body>
</html>
