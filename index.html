<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>ã‚µã‚¤ã‚³ãƒ­ã®è¡“ ğŸ²</title>
<meta name="description" content="ã‚¯ã‚¤ãƒƒã‚¯ / æ±ºã‚ã‚‹ / RPG ã®3ãƒ¢ãƒ¼ãƒ‰ã€‚å¤§ããè¦‹ã‚„ã™ã„ã‚µã‚¤ã‚³ãƒ­ã€ã‚¹ãƒ¯ã‚¤ãƒ—ã§å†ãƒ­ãƒ¼ãƒ«ã€‚ã‚·ãƒ³ãƒ—ãƒ«UIã€‚">

<style>
  :root{
    --bg:#f7f7fb; --fg:#111827; --muted:#6b7280;
    --die:#ffffff; --border:#e5e7eb; --radius:18px;
    --pip:28%; --gap:12px; --die-min:110px;
    --btn1:#6366f1; --btn2:#06b6d4; /* ãƒœã‚¿ãƒ³/ãƒãƒƒãƒ—ã®ã‚°ãƒ©ãƒ‡ */
  }
  @media (prefers-color-scheme: dark){
    :root{
      --bg:#0b0d12; --fg:#e5e7eb; --muted:#9aa2b2;
      --die:#15192d; --border:#2a2f45;
      --btn1:#7c7bff; --btn2:#3bd6e9;
    }
  }
  *{box-sizing:border-box}
  body{
    margin:0; font-family: system-ui,-apple-system,"Segoe UI",Roboto,"Hiragino Kaku Gothic ProN",sans-serif;
    background:
      radial-gradient(1000px 700px at 80% -10%, rgba(99,102,241,.10), transparent 50%),
      radial-gradient(900px 600px at -10% 40%, rgba(6,182,212,.10), transparent 55%),
      var(--bg);
    color:var(--fg); padding:16px; line-height:1.45;
  }
  h1{margin:0 0 8px; font-size: clamp(18px,4.5dvw,28px); font-weight:800;}
  .sub{color:var(--muted); margin-bottom:14px; font-size:.95rem}

  /* ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿ãƒãƒƒãƒ— */
  .chips{display:flex; flex-wrap:wrap; gap:8px; margin:10px 0 14px}
  .chip{
    border:1px solid var(--border); border-radius:999px; padding:10px 14px;
    background:transparent; color:var(--fg); font-weight:700; cursor:pointer;
  }
  .chip.active{
    color:#fff; border-color: transparent;
    background: linear-gradient(135deg, var(--btn1), var(--btn2));
  }

  /* ãƒ¡ã‚¤ãƒ³ãƒœã‚¿ãƒ³ */
  .primary{
    width:100%; border:none; border-radius:14px; padding:16px 18px; font-weight:800;
    font-size: clamp(16px,3.8dvw,20px); color:#fff;
    background: linear-gradient(135deg, var(--btn1), var(--btn2));
    box-shadow: 0 10px 24px rgba(0,0,0,.12);
    cursor:pointer;
  }

  /* ãƒˆã‚°ãƒ«ï¼ˆãƒã‚¤ãƒ–ï¼‰ */
  .opts{display:flex; align-items:center; gap:12px; margin-bottom:10px}
  .tog{display:inline-flex; align-items:center; gap:8px; border:1px solid var(--border); border-radius:10px; padding:8px 12px}
  .tog input{accent-color:#3b82f6}

  /* ã‚¯ã‚¤ãƒƒã‚¯ï¼šãƒ€ã‚¤ã‚¹ç›¤é¢ */
  .dice-area{
    margin-top:14px;
    display:grid; grid-template-columns: repeat(auto-fit, minmax(var(--die-min), 1fr));
    gap: var(--gap);
  }
  .dice-area.one{ --die-min: min(72dvw, 260px); --pip:34%; --gap:16px;}
  .dice-area.few{ --die-min: 140px; --pip:30%; --gap:14px;}
  .dice-area.many{ --die-min: 110px; --pip:26%; --gap:12px;}

  .die{
    aspect-ratio:1/1; border-radius: var(--radius); background: var(--die);
    border:1px solid var(--border); display:grid; place-items:center; position:relative;
    /* å‡ºç›®è‰²ï¼šCSSå¤‰æ•° --h ã‚’å—ã‘å–ã‚‹ï¼ˆæ·¡è‰²ã®ãƒªãƒ³ã‚°ï¼‰ */
    --h: 210;
    background:
      radial-gradient(60% 55% at 50% 35%, hsl(var(--h) 100% 94%) 0%, transparent 65%),
      var(--die);
    box-shadow:
      0 6px 18px hsl(var(--h) 80% 40% / .10),
      inset 0 0 0 1px hsl(var(--h) 60% 75% / .40);
  }
  @media (prefers-color-scheme: dark){
    .die{
      background:
        radial-gradient(60% 55% at 50% 35%, hsl(var(--h) 80% 20% / .55) 0%, transparent 65%),
        var(--die);
      box-shadow:
        0 8px 20px hsl(var(--h) 80% 30% / .25),
        inset 0 0 0 1px hsl(var(--h) 70% 55% / .30);
    }
  }
  .face{
    position:absolute; inset:8%; border-radius:14px;
    display:grid; grid-template-columns: repeat(3,1fr); grid-template-rows: repeat(3,1fr);
    place-items:center; gap:4%;
  }
  .pip{
    width: var(--pip); aspect-ratio:1/1; border-radius:50%;
    background:#111827; box-shadow: inset 0 -1px 1px rgba(255,255,255,.35);
  }
  @media (prefers-color-scheme: dark){
    .pip{ background:#ffffff; box-shadow:none; }
  }

  .result{
    margin-top:12px; font-weight:800; font-size: clamp(16px,3.5dvw,22px);
    display:inline-block; padding:6px 10px; border-radius:10px;
    background: linear-gradient(135deg, var(--btn1), var(--btn2));
    color:#fff;
  }
  .hint{ color:var(--muted); font-size:.92rem; margin-top:6px}

  /* æ±ºã‚ã‚‹ï¼ˆ1ã€œNï¼‰ */
  .decide-wrap{display:flex; gap:10px; align-items:center; margin:6px 0 12px}
  .num-input{
    flex:1; border:1px solid var(--border); border-radius:12px; padding:12px 14px;
    font-weight:700; font-size:1rem; background:var(--die); color:var(--fg);
  }
  .num-input:invalid{ outline:2px solid #ef4444 }

  /* RPGãƒ¢ãƒ¼ãƒ‰ã®ãƒ€ã‚¤ã‚¹ç¨® */
  .dice-types{display:flex; flex-wrap:wrap; gap:8px; margin:6px 0 12px}

  /* ãƒ•ãƒƒã‚¿ãƒ¼ï¼ˆæœ€å°ï¼‰ */
  #footer{ margin-top:22px; color:var(--muted); font-size:.9rem; text-align:center}
  #footer a{ color:inherit; text-decoration:underline}
</style>
</head>
<body>
  <h1>ã‚µã‚¤ã‚³ãƒ­ã®è¡“ ğŸ²</h1>
  <div class="sub">ã‚¯ã‚¤ãƒƒã‚¯ / æ±ºã‚ã‚‹ / RPGã€‚å¿…è¦ãªã¨ãã«ã€1ã‚¿ãƒƒãƒ—ã€‚</div>

  <!-- ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿ -->
  <div class="chips" id="modeChips">
    <button class="chip active" data-mode="quick">ã‚¯ã‚¤ãƒƒã‚¯</button>
    <button class="chip" data-mode="decide">æ±ºã‚ã‚‹</button>
    <button class="chip" data-mode="rpg">RPG</button>
  </div>

  <!-- å…±é€šã‚ªãƒ—ã‚·ãƒ§ãƒ³ -->
  <div class="opts">
    <label class="tog"><input type="checkbox" id="vib" checked> ãƒã‚¤ãƒ–</label>
    <div style="color:var(--muted); font-size:.9rem">â€»ä¸‹â†’ä¸Šã‚¹ãƒ¯ã‚¤ãƒ—ã§å†ãƒ­ãƒ¼ãƒ«</div>
  </div>

  <!-- ã‚¯ã‚¤ãƒƒã‚¯ï¼šã‚µã‚¤ã‚³ãƒ­å€‹æ•° -->
  <div id="quick" class="mode">
    <div class="chips" id="countChips">
      <button class="chip" data-n="1">1å€‹</button>
      <button class="chip active" data-n="2">2å€‹</button>
      <button class="chip" data-n="3">3å€‹</button>
      <button class="chip" data-n="4">4å€‹</button>
      <button class="chip" data-n="5">5å€‹</button>
      <button class="chip" data-n="6">6å€‹</button>
    </div>
    <button id="rollQuick" class="primary">æŒ¯ã‚‹ï¼</button>
    <div id="diceArea" class="dice-area"></div>
    <div id="sumQuick" class="result" style="display:none"></div>
    <div id="detailQuick" class="hint" style="display:none"></div>
  </div>

  <!-- æ±ºã‚ã‚‹ï¼š1ã€œN ã®æ•´æ•° -->
  <div id="decide" class="mode" style="display:none">
    <div class="decide-wrap">
      <label for="maxN" class="sub" style="min-width:4.5em">æœ€å¤§N</label>
      <input id="maxN" class="num-input" type="number" inputmode="numeric" min="2" max="999999" value="6" />
    </div>
    <button id="rollDecide" class="primary">æŒ¯ã‚‹ï¼</button>
    <div id="sumDecide" class="result" style="display:none"></div>
  </div>

  <!-- RPGï¼šãƒ€ã‚¤ã‚¹ç¨®ï¼ˆ1å€‹ï¼‰-->
  <div id="rpg" class="mode" style="display:none">
    <div class="dice-types" id="typeChips">
      <button class="chip active" data-sides="6">D6</button>
      <button class="chip" data-sides="8">D8</button>
      <button class="chip" data-sides="10">D10</button>
      <button class="chip" data-sides="12">D12</button>
      <button class="chip" data-sides="20">D20</button>
    </div>
    <button id="rollRPG" class="primary">æŒ¯ã‚‹ï¼</button>
    <div id="sumRPG" class="result" style="display:none"></div>
  </div>

  <div id="footer">
    X <a href="https://x.com/kkp_webninja" target="_blank">@kkp_webninja</a> ãƒ»
    ğŸ¯ <a href="https://kkpwebninja.com" target="_blank">æœ¬ä¸¸</a>
  </div>

<script>
const $ = s => document.querySelector(s);
const $$ = s => [...document.querySelectorAll(s)];

/* ====== çŠ¶æ…‹ ====== */
let mode = 'quick';
let diceCount = 2;     // ã‚¯ã‚¤ãƒƒã‚¯
let rpgSides = 6;      // RPG
let lastAction = null; // ã‚¹ãƒ¯ã‚¤ãƒ—å†ãƒ­ãƒ¼ãƒ«ã§ä½¿ã†

/* ====== å‡ºç›®â†’è‰²ç›¸ ====== */
const HUES = [355, 25, 50, 200, 150, 280]; // 1:èµ¤,2:æ©™,3:é»„ç·‘,4:æ°´è‰²,5:ãƒŸãƒ³ãƒˆ,6:ç´«

/* ====== ãƒ”ãƒƒãƒ—é…ç½®ï¼ˆ3x3ï¼‰ ====== */
function pipLayout(n){
  const one =   [0,0,0, 0,1,0, 0,0,0];
  const two =   [1,0,0, 0,0,0, 0,0,1];
  const three = [1,0,0, 0,1,0, 0,0,1];
  const four =  [1,0,1, 0,0,0, 1,0,1];
  const five =  [1,0,1, 0,1,0, 1,0,1];
  const six =   [1,0,1, 1,0,1, 1,0,1];
  return [one,two,three,four,five,six][n-1];
}
function createDie(face=1){
  const d = document.createElement('div');
  d.className = 'die';
  d.style.setProperty('--h', HUES[face-1] ?? 210);
  const f = document.createElement('div'); f.className = 'face';
  const layout = pipLayout(face);
  for(let i=0;i<9;i++){
    if(layout[i]){ const p=document.createElement('div'); p.className='pip'; f.appendChild(p); }
    else{ f.appendChild(document.createElement('div')); }
  }
  d.appendChild(f);
  return d;
}

/* ====== ã‚¯ã‚¤ãƒƒã‚¯ï¼šå€‹æ•°ã§ã‚µã‚¤ã‚ºã‚¯ãƒ©ã‚¹ä»˜ä¸ ====== */
const diceArea = $('#diceArea');
function applyGridClass(n){
  diceArea.classList.remove('one','few','many');
  if(n===1) diceArea.classList.add('one');
  else if(n<=3) diceArea.classList.add('few');
  else diceArea.classList.add('many');
}

/* ====== ãƒã‚¤ãƒ– ====== */
function buzz(){ if($('#vib').checked && navigator.vibrate) navigator.vibrate(18); }

/* ====== ãƒ­ãƒ¼ãƒ«å‡¦ç† ====== */
function rollQuick(){
  applyGridClass(diceCount);
  diceArea.innerHTML = '';
  const faces = [];
  let sum = 0;
  for(let i=0;i<diceCount;i++){
    const r = (Math.random()*6|0)+1;
    faces.push(r); sum += r;
    diceArea.appendChild(createDie(r));
  }
  $('#sumQuick').textContent = `åˆè¨ˆ ${sum}`;
  $('#sumQuick').style.display = 'inline-block';
  $('#detailQuick').textContent = `å†…è¨³: ${faces.join(' / ')}`;
  $('#detailQuick').style.display = 'block';
  buzz();
  lastAction = rollQuick;
}
function rollDecide(){
  const max = parseInt($('#maxN').value,10);
  if(!Number.isFinite(max) || max < 2 || max > 999999){
    $('#maxN').focus();
    $('#maxN').reportValidity?.();
    return;
  }
  const val = (Math.random()*max|0)+1;
  $('#sumDecide').textContent = String(val);
  $('#sumDecide').style.display = 'inline-block';
  buzz();
  lastAction = rollDecide;
}
function rollRPG(){
  const val = (Math.random()*rpgSides|0)+1;
  $('#sumRPG').textContent = `D${rpgSides} â†’ ${val}`;
  $('#sumRPG').style.display = 'inline-block';
  buzz();
  lastAction = rollRPG;
}

/* ====== ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿ ====== */
function switchMode(next){
  if(mode === next) return;
  mode = next;
  $$('.chip[data-mode]').forEach(c=>c.classList.toggle('active', c.dataset.mode===next));
  // è¡¨ç¤ºåˆ‡æ›¿
  $('#quick').style.display = (next==='quick') ? 'block' : 'none';
  $('#decide').style.display = (next==='decide') ? 'block' : 'none';
  $('#rpg').style.display   = (next==='rpg') ? 'block' : 'none';
  // ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ç³»ãƒªã‚»ãƒƒãƒˆè»½ã‚
  if(next==='quick') { $('#sumQuick').style.display='none'; $('#detailQuick').style.display='none'; diceArea.innerHTML=''; }
  if(next==='decide'){ $('#sumDecide').style.display='none'; }
  if(next==='rpg')   { $('#sumRPG').style.display='none'; }
  // ç›´å‰ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ç„¡åŠ¹ï¼ˆèª¤ã‚¹ãƒ¯ã‚¤ãƒ—é˜²æ­¢ï¼‰
  lastAction = null;
}

/* ====== ã‚¤ãƒ™ãƒ³ãƒˆç™»éŒ² ====== */
// ãƒ¢ãƒ¼ãƒ‰
$('#modeChips').addEventListener('click', e=>{
  const b = e.target.closest('.chip'); if(!b) return;
  switchMode(b.dataset.mode);
});
// ã‚¯ã‚¤ãƒƒã‚¯ï¼šå€‹æ•°
$('#countChips').addEventListener('click', e=>{
  const b = e.target.closest('.chip'); if(!b) return;
  $$('#countChips .chip').forEach(c=>c.classList.remove('active'));
  b.classList.add('active');
  diceCount = parseInt(b.dataset.n,10);
  applyGridClass(diceCount);
});
// RPGï¼šé¢æ•°
$('#typeChips').addEventListener('click', e=>{
  const b = e.target.closest('.chip'); if(!b) return;
  $$('#typeChips .chip').forEach(c=>c.classList.remove('active'));
  b.classList.add('active');
  rpgSides = parseInt(b.dataset.sides,10);
});

// ãƒœã‚¿ãƒ³
$('#rollQuick').addEventListener('click', rollQuick);
$('#rollDecide').addEventListener('click', rollDecide);
$('#rollRPG').addEventListener('click', rollRPG);

/* ====== ã‚¹ãƒ¯ã‚¤ãƒ—ã§å†ãƒ­ãƒ¼ãƒ«ï¼ˆä¸‹â†’ä¸Šï¼‰ ====== */
let tStartY = null;
window.addEventListener('touchstart', e=>{
  tStartY = e.changedTouches?.[0]?.clientY ?? null;
},{passive:true});
window.addEventListener('touchend', e=>{
  const endY = e.changedTouches?.[0]?.clientY ?? null;
  if(tStartY==null || endY==null) return;
  const dy = endY - tStartY; // ä¸Šã«ã‚¹ãƒ¯ã‚¤ãƒ—ã§è² 
  if(dy < -40){ // ä¸Šæ–¹å‘ã—ãã„å€¤
    if(mode==='quick') rollQuick();
    else if(mode==='decide') rollDecide();
    else if(mode==='rpg') rollRPG();
  }
  tStartY = null;
},{passive:true});

/* ====== åˆæœŸçŠ¶æ…‹ ====== */
switchMode('quick');
applyGridClass(diceCount);
</script>
</body>
</html>
